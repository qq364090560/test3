(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f6f68b7"],{"682c":function(e,t,a){"use strict";a("874c")},"874c":function(e,t,a){},ccc0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"container"},[a("el-card",{staticClass:"left-card"},[a("div",{staticClass:"text item"},[a("el-row",[a("el-col",[a("h4",{staticStyle:{padding:"10px"}},[e._v("组织列表")])]),a("el-col",[a("el-tree",{attrs:{data:e.data,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1)],1)],1)]),a("el-card",{staticClass:"right-card"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加角色")]),a("el-card",{staticClass:"rTopCard"},[e.tags.length?a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:e.rdelFlag?"danger":"primary",disabled:!e.val},on:{click:function(t){return e.onDel(e.val)}}},[e._v(e._s(e.rdelFlag?"禁用角色":"启用角色"))])],1),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeFlag},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}},e._l(e.tags,(function(e){return a("el-option",{key:e.rid,attrs:{label:e.roleName,value:e.rid}})})),1)],1)],1):e._e(),e.tags.length>0?a("div",[a("el-row",e._l(e.tags,(function(t,r){return a("el-button",{key:r,attrs:{type:e.activeIndex==r?"primary":"",disabled:!t.rdelFlag},on:{click:function(a){return e.tagsHandle(t.rid,r)}}},[e._v(e._s(t.roleName))])})),1)],1):a("div",[e._v("数据为空")])],1),a("el-card",{staticClass:"rBottomCard"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"tree"},[a("el-row",[a("el-col",[a("h4",{staticStyle:{padding:"10px"}},[e._v("系统授权")])]),a("el-col",[a("el-tree",{ref:"tree",staticStyle:{height:"50vh",overflow:"auto"},attrs:{data:e.menuData,"show-checkbox":"",props:e.menuProps,"node-key":"mid"},on:{"node-click":e.menuHandle,check:e.isCheak}})],1)],1)],1),e.authority?a("div",{staticClass:"menuBox"},[a("div",{staticClass:"center"},[e.authority.mfunction?a("div",{staticClass:"center"},[a("h1",[e._v(e._s(e.authority.mnameCn+"权限"))]),a("el-checkbox-group",{staticClass:"menuCheckbox",on:{change:e.clickChange},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("el-checkbox",{attrs:{label:"query"}},[e._v("查询")]),a("el-checkbox",{attrs:{label:"insert"}},[e._v("添加")]),a("el-checkbox",{attrs:{label:"delete"}},[e._v("删除")]),a("el-checkbox",{attrs:{label:"update"}},[e._v("更新")])],1)],1):e._e()])]):e._e()]),e.authority?a("div",{staticClass:"footBtn"},[a("el-button",{attrs:{id:"btn",type:"primary"},on:{click:e.onSave}},[e._v("保存")])],1):e._e()])],1),a("el-dialog",{attrs:{title:"添加角色",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1),a("el-form-item",{attrs:{label:"组织标识",prop:"orgId"}},[a("el-cascader",{attrs:{options:e.orgOptions,props:e.orgProps,clearable:""},on:{change:e.orgHandle}})],1),a("el-form-item",{attrs:{label:"备注",prop:"rRemark"}},[a("el-input",{model:{value:e.addForm.rRemark,callback:function(t){e.$set(e.addForm,"rRemark",t)},expression:"addForm.rRemark"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClear}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1)],1)},n=[],o=(a("fc02"),a("566e"),a("4ec3")),s={data:function(){return{activeIndex:-1,val:"",rdelFlag:1,authority:"",checkList:[],rId:null,dialogFormVisible:!1,addForm:{},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],orgId:[{required:!0,message:"请选择组织",trigger:"blur"}],rRemark:[{required:!0,message:"请输入备份",trigger:"blur"}]},orgProps:{value:"oid",label:"oname",children:"child",checkStrictly:!0,expandTrigger:"hover"},orgOptions:[],data:[],defaultProps:{children:"child",label:"oname"},treeArr:[],tags:[],menuData:[],menuProps:{children:"childMenu",label:"mnameCn"},menuArr:[]}},methods:{clickChange:function(e){this.authority.mfunction=e.join(",")},changeFlag:function(e){var t=this;this.tags.map((function(a){a.rid==e&&(t.rdelFlag=a.rdelFlag)})),console.log(this.rdelFlag)},onDel:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){setTimeout((function(){Object(o["q"])({rId:e,delFlag:!t.rdelFlag}).then((function(a){t.$message({type:"success",message:"成功"}),Object(o["K"])({orgId:e}).then((function(e){t.tags=e.data}))}))}),10)})).catch((function(){t.$message({type:"info",message:"已取消"})}))},onSave:function(){var e=this,t=this.$refs.tree.getCheckedNodes(!1,!0),a=[];t.map((function(e){var t={menuId:e.mid,function:e.mfunction};a.push(t)}));var r={rId:this.rId,menus:JSON.stringify(a)};Object(o["b"])(r).then((function(t){200==t.status?e.$message({message:t.message,type:"success"}):e.$message.error(t.message)}))},onClear:function(){this.addForm={},this.dialogFormVisible=!1},addRole:function(){var e=this;this.$refs.addForm.validate((function(t){t&&Object(o["g"])(e.addForm).then((function(t){e.$message({message:t.message,type:"success"}),e.onClear()}))}))},orgHandle:function(e){this.addForm.orgId=e[e.length-1]},handleNodeClick:function(e){var t=this;this.menuData=[],Object(o["K"])({orgId:e.oid}).then((function(e){t.tags=e.data}))},menuHandle:function(e){console.log(e),this.authority=e,e.mfunction&&(this.checkList=e.mfunction.split(","))},isCheak:function(e,t){console.log(e,t),this.menuArr=t.checkedNodes},tagsHandle:function(e,t){var a=this;this.activeIndex=t,this.rId=e,this.$axios.all([Object(o["B"])(),Object(o["I"])({rId:e})]).then((function(e){a.menuData=e[0].data.menus;var t=e[1].data,r=[],n=[];t.map((function(e){a.menuData.map((function(t){e.mId==t.mid&&r.push(t),t.childMenu.map((function(t){t.mid==e.mId&&r.push(t)}))}))})),r.map((function(e){null==e.childMenu&&n.push(e.mid)})),a.$refs.tree.setCheckedKeys(n)}))}},created:function(){var e=this,t={userid:JSON.parse(sessionStorage.getItem("userInfo")).userId,groupid:JSON.parse(sessionStorage.getItem("userInfo")).groupId};Object(o["J"])(t).then((function(t){e.data=t.data,e.orgOptions=t.data}))}},l=s,i=(a("682c"),a("cba8")),c=Object(i["a"])(l,r,n,!1,null,"1144dd24",null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-3f6f68b7.dbaefa3b.js.map